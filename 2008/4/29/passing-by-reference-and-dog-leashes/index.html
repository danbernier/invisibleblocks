<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Passing by reference, and dog leashes | </title>
    <meta name="description" content="I make <a href='http://wordcram.org'>WordCram</a>, and try to make generative art in <a href='http://processing.org'>Processing</a>. I read a fair bit, and I try to write well. I co-organize <a href='http://newhaven.io'>NewHaven.IO</a> and <a href='http://newhavenrb.org'>NewHaven.rb</a>. This is my blog.
">

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="/2008/4/29/passing-by-reference-and-dog-leashes/">

    <script src="/javascript/main.js"></script>
    <script src="/javascript/p5.min.js"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Invisible Blocks</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">What's all this, then?</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Passing by reference, and dog leashes</h1>
    <p class="post-meta">Apr 29, 2008 • Dan Bernier</p>
  </header>

  <article class="post-content">
    <p>Pass-by-reference and pass-by-value are pretty confusing when you start learning to code.  When I first saw them, I know I ignored the distinction (until I got tired of my code not doing what I expected).  Throwing collections into the mix just makes it worse.</p>

<p>Today, though, we stumbled on a pretty decent analogy for passing-by-reference: a reference to an object is like a leash to a dog.  Let’s take our dog Dagwood for a walk.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">Dog</span> <span class="n">dagwood</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Dog</span><span class="p">(</span><span class="s">"Dagwood"</span><span class="p">);</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p><code class="highlighter-rouge">new Dog()</code> creates, of course, a new Dog object.  <code class="highlighter-rouge">Dog dagwood</code> creates a reference that can point to any Dog object – it’s really the leash, but we name our references for what they point to, rather than what they are: a reference, a handle, a leash.  The equals sign takes the leash, and hooks it to Dagwood’s collar.  Now we can take Dagwood for a walk.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">dagwood</span><span class="p">.</span><span class="nf">walk</span><span class="p">();</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>To tell Dagwood it’s time to walk, we tug on the leash.  He feels the tug, and gets the message, so he starts following us.  We come to a busy road, and wait for the crossing signal, but Dagwood’s oblivious, and tries to cross anyway.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">dagwood</span><span class="p">.</span><span class="nf">halt</span><span class="p">();</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Since we’re stopped, he feels the tug of the leash again, gets the message, and stops.  We’re sending messages to Dagwood through his leash.  In OO terms, sending a message to an object means calling one of its methods.  We’re calling methods on our Dagwood <strong>through</strong> our reference to him, through the leash.</p>

<p><strong>Storing a reference in an array</strong></p>

<p>In the park, we find a snack shop.  We’re getting hungry, but the snack shop doesn’t let dogs inside.  Luckily, there’s a chain link fence, and in our eyes, a chain link fence is nothing but a big row of places for us to attach a dog leash.  We tie a spare leash to the end of the fence, and attach it to Dagwood’s collar.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="n">Dog</span><span class="p">[]</span> <span class="n">fence</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="p">[</span><span class="m">10</span><span class="p">];</span> <span class="c1">// only room for 10 dogs
</span><span class="n">fence</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="n">dagwood</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>What’s happening here in OO terms is that our reference to Dagwood, our leash, is <strong>copied</strong> into the zeroth slot on the fence.  It’s not our leash, but it’s one just like it.  So now there are two leashes on Dagwood: one in our hand, and one on the fence.  We’ll take our leash off Dagwood, since we can’t very well hold it while we’re in the store.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">dagwood</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Don’t worry, he’s fine…he’s still tied to the fence, by that other leash.  Let’s go buy cashews.</p>

<p>When we come out of the store, we want to re-attach our leash to Dagwood.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">dagwood</span> <span class="p">=</span> <span class="n">fence</span><span class="p">[</span><span class="m">0</span><span class="p">];</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Now let’s untie him from the fence, and head over to the lake.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">fence</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p><strong>Passing by reference</strong></p>

<p>Passing references to methods works in much the same way.  Dagwood got kind of stinky, swimming in the lake, so let’s bring him to the groomer for a bath.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">DogGroomer</span><span class="p">.</span><span class="nf">shampoo</span><span class="p">(</span><span class="n">dagwood</span><span class="p">);</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>When you pass a reference to a method, your reference is copied into that method.  Again, it’s like a new leash, one just like ours, springs into the groomer’s hand – now Dagwood’s attached to us, and the groomer.  He gets fidgety when he’s getting bathed, so it’s just as well.</p>

<p>From the groomer’s perspective, it might look like this:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="k">void</span> <span class="nf">shampoo</span><span class="p">(</span><span class="n">Dog</span> <span class="n">doggie</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">wet</span><span class="p">(</span><span class="n">doggie</span><span class="p">);</span>
    <span class="nf">apply</span><span class="p">(</span><span class="n">shampoo</span><span class="p">,</span> <span class="n">doggie</span><span class="p">);</span>
    <span class="nf">rinse</span><span class="p">(</span><span class="n">doggie</span><span class="p">);</span>
    <span class="nf">towelDry</span><span class="p">(</span><span class="n">doggie</span><span class="p">);</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>The groomer doesn’t care what Dagwood’s name is, she just keeps calling him “doggie.”  That’s ok, she must see a lot of dogs during the day…names aren’t that important to her.  The interesting thing is, even though it’s the groomer who’s shampooing our dog, since we still have a leash on him, we can observe him getting cleaner.</p>

<p>When she’s done, the procedure ends, the method returns, and her leash to Dagwood disappears.  Which is fine, because he’s stopped fidgeting, now that he’s dry.</p>

<p><strong>Garbage collection</strong></p>

<p>We head back home through the park.  Dagwood’s itching to run around, but we’re tired, so we just unleash him.  Hopefully we can find him before it gets dark…</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">dagwood</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Unfortunately, the dog catcher spots him running around without a leash, which is illegal in these parts – a stray dog will hang around forever, eating up resources.  The dog catcher carries off our poor Dagwood, and destroys him.  We take it in stride, and try to keep the whole circle of <span style="text-decoration:line-through;">life</span> allocation-deallocation in mind.</p>

<p><strong>So…</strong></p>

<p>So that’s how references work.  It’s why code like this (C#) will ensure the balloon bouquet has at least one balloon that says “Happy Birthday!”:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="n">List</span><span class="p">&lt;</span><span class="n">Balloon</span><span class="p">&gt;</span> <span class="n">balloons</span> <span class="p">=</span> <span class="nf">GetBalloons</span><span class="p">();</span>
<span class="n">Balloon</span> <span class="n">printed</span> <span class="p">=</span> <span class="n">balloons</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">Balloon</span><span class="p">.</span><span class="n">IsPrinted</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">printed</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">printed</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Balloon</span><span class="p">();</span>
   <span class="n">printed</span><span class="p">.</span><span class="nf">PrintMessage</span><span class="p">(</span><span class="s">"Happy Birthday!"</span><span class="p">);</span>
   <span class="n">balloons</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">printed</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">return</span> <span class="n">balloons</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


  </article>

  
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">


    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <h2 class="footer-heading">Invisible Blocks</h2>
        <p class="text">for building invisible machines</p>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/danbernier">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">danbernier</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/danbernier">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">danbernier</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">I make <a href='http://wordcram.org'>WordCram</a>, and try to make generative art in <a href='http://processing.org'>Processing</a>. I read a fair bit, and I try to write well. I co-organize <a href='http://newhaven.io'>NewHaven.IO</a> and <a href='http://newhavenrb.org'>NewHaven.rb</a>. This is my blog.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
