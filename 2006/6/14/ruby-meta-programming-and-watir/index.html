<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Ruby, Meta-programming, and Watir | </title>
    <meta name="description" content="I make <a href='http://wordcram.org'>WordCram</a>, and try to make generative art in <a href='http://processing.org'>Processing</a>. I read a fair bit, and I try to write well. I co-organize <a href='http://newhaven.io'>NewHaven.IO</a> and <a href='http://newhavenrb.org'>NewHaven.rb</a>. This is my blog.
">

    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="/2006/6/14/ruby-meta-programming-and-watir/">

    <script src="/javascript/main.js"></script>
    <script src="/javascript/p5.min.js"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Invisible Blocks</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">What's all this, then?</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Ruby, Meta-programming, and Watir</h1>
    <p class="post-meta">Jun 14, 2006 • Dan Bernier</p>
  </header>

  <article class="post-content">
    <h3 id="watir--web-app-testing-in-ruby">WATIR – Web App Testing In Ruby</h3>

<p>I’ve been playing with <a href="http://wtr.rubyforge.org">Watir</a> recently (thanks for the tip, Ken!), since the folks at my new job have (ahem) no real QA team or process.  Watir lets you create and drive an Internet Explorer browser with Ruby (via the Win32 API library), so you       can script (and save, and frequently run) a whole suite of regression tests.  It’s a great library—it’s easy, clean, immediately rewarding, lots of fun, and implemented fairly simply.  Let’s   use it to search Google for ‘Watir’:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="nb">require</span> <span class="s1">'watir'</span>
<span class="n">ie</span> <span class="o">=</span> <span class="no">Watir</span><span class="o">::</span><span class="no">IE</span><span class="p">.</span><span class="nf">new</span>  <span class="c1"># launch a new IE browser</span>
<span class="n">ie</span><span class="p">.</span><span class="nf">goto</span><span class="p">(</span><span class="s2">"http://www.google.com"</span><span class="p">)</span>   <span class="c1"># send it to Google</span>

<span class="c1"># Get the query input (the text field named "q"),</span>
<span class="c1"># and set it to "Watir"</span>
<span class="n">ie</span><span class="p">.</span><span class="nf">text_field</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s2">"q"</span><span class="p">).</span><span class="nf">set</span><span class="p">(</span><span class="s2">"Watir"</span><span class="p">)</span>

<span class="c1"># Get the search button (whose value, or text, matches the</span>
<span class="c1"># Regexp /search/), and click it</span>
<span class="n">ie</span><span class="p">.</span><span class="nf">button</span><span class="p">(</span><span class="ss">:value</span><span class="p">,</span> <span class="sr">/search/i</span><span class="p">).</span><span class="nf">click</span>

<span class="c1"># Find the link that includes "web application testing",</span>
<span class="c1"># and click it</span>
<span class="n">ie</span><span class="p">.</span><span class="nf">link</span><span class="p">(</span><span class="ss">:text</span><span class="p">,</span> <span class="sr">/web application testing/i</span><span class="p">).</span><span class="nf">click</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>I did that all from memory, and made only two mistakes (I forgot the Regexps should be case-insensitive, and I looked for the “Search” button by :label instead of :value).  Go ahead—install ruby, run <code class="highlighter-rouge">gem install watir</code> (what’s <a href="http://www.rubygems.org/read/chapter/1">gem</a>?), and try it out.</p>

<p>Watir makes it easy to find any HTML element on the page, if it has a name, id, title, or value…but it <em>doesn’t</em> let you search by CSS class, which I consider a significant omission (plenty of generated HTML has consistent style names, but generated IDs).  Looking at the source, I think the authors assumed you would be only looking for one element (<code class="highlighter-rouge">ie.text_field(:name, "q")</code>), or all of a given kind of element (<code class="highlighter-rouge">ie.divs</code>).</p>

<p>Also, suppose you grabbed that paragraph about avocados, and now want the second link <em>inside</em> that paragraph—<code class="highlighter-rouge">ie.p(:name, 'avocados').links(:index, 2)</code> <em>doesn’t work</em>.  If the HTML elements you want have no id or name, the ability to traverse the DOM hierarchy is pretty important.  This also is a problem for me.</p>

<p>So I set about trying to improve Watir, to see if I could add this functionality.  Along the way, I decided to write my own wrapper around IE’s DOM interface (exposed through Ruby’s WIN32OLE object), and I’ll try to re-write the DOM parts of Watir using it.  If it goes well, I’ll submit it to the Watir team, but even if it doesn’t, I’m learning a <em>lot</em> about Ruby, and really starting to like it.  Call me a fanboy.</p>

<p>Here, I’m writing about the prizes I find along the way—things I’m learning, the neat approaches, or things that confused me at first.  It’s aimed at someone who (hey, just like me!) has learned enough Ruby to do the basics, but wants more information on the parts of Ruby that aren’t found in C-based, OO languages.  If you stop reading here, you’ve already picked up a great tip—go download <a href="http://wtr.rubyforge.org/">Watir</a>.  The curious rest of you, let’s proceed…</p>

<h3 id="delegation-made-trivial">Delegation Made Trivial</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">Node</span>
    <span class="c1"># Auto-wrap the @ole_node</span>
    <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="n">method_id</span><span class="p">)</span>
        <span class="vi">@ole_node</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">method_id</span><span class="p">.</span><span class="nf">id2name</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Watir hands out the OLE Document object, and the Node class (and its subclasses) wraps it, adding some functionality and OO pleasantness…but there are times we’d like to access the WIN32OLE’s methods.  We could expose the OLE through an accessor method, but what we really want is to talk to the Node like it’s the OLE.  Here’s the part I like: instead of writing a hundred lines of delegator methods, we implement <code class="highlighter-rouge">method_missing</code>.  If a Node is sent a message it doesn’t understand (a call to a method it doesn’t implement), it just forwards the message to its WIN32OLE.</p>

<p>To do this, we override Object’s method_missing method—it’s a hook for just this situation.  We’re passed the name of the missing method, and we can use the <code class="highlighter-rouge">object.send("method_name")</code> syntax for calling methods.  My example is really simple—<em>every</em> method of WIN32OLE is exposed through Node, with the same name.  To restrict it, I’ll probably add an Array of methods I want to expose, and only delegate <code class="highlighter-rouge">if wrapped_methods.include? method_name</code>.  If I want to get fancy, I’ll use a Hash to map the method names, so <code class="highlighter-rouge">node.tag</code> delegates to <code class="highlighter-rouge">@ole_node.tagName</code>.</p>

<p>This trick, I think, is possible because Ruby is <a href="http://en.wikipedia.org/wiki/Dynamic_typing">dynamically typed</a>.  Ruby’s willingness to send any message to any object is what makes this work.</p>

<h3 id="meta-programming-and-then-some">Meta-programming, and Then Some</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="n">searchable_tags</span> <span class="o">=</span> <span class="sx">%w[a p div span input table]</span>

<span class="n">searchable_tags</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">tag</span><span class="o">|</span>
    <span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">METHOD_TEMPLATE</span><span class="sh">
        def </span><span class="si">#{</span><span class="n">tag</span><span class="si">}</span><span class="sh">s (*args, &amp;proc)
            proc ||= make_filter(args)
            self.find_all { |n|
                n.tagName.upcase == "</span><span class="si">#{</span><span class="n">tag</span><span class="p">.</span><span class="nf">upcase</span><span class="si">}</span><span class="sh">" and proc.call(n)
            }
        end
</span><span class="no">METHOD_TEMPLATE</span>
    <span class="nb">module_eval</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This is maybe a bit a dense…I’ll explain first.</p>

<h3 id="lets-just-find-the-divs">Let’s Just Find the Divs</h3>

<p>I like Watir’s style of searching for elements: <code class="highlighter-rouge">ie.div(:name, "header")</code> returns the div named ‘header’, and <code class="highlighter-rouge">ie.divs</code> returns all divs.  I decided to copy this, but make it a bit more general:  both versions (div and divs) should accept multiple filter parameters, so you can search by zero, one, or more attributes.  The singular version (div) should return the first match, the plural (divs) should return all matches.  For example:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="n">doc</span><span class="p">.</span><span class="nf">div</span>  <span class="c1"># the first div</span>
<span class="n">doc</span><span class="p">.</span><span class="nf">div</span><span class="p">(</span><span class="ss">:class</span><span class="p">,</span> <span class="s2">"blue_text"</span><span class="p">)</span> <span class="c1"># the first div whose class is "blue_text"</span>
<span class="n">doc</span><span class="p">.</span><span class="nf">divs</span>  <span class="c1"># all divs</span>
<span class="n">doc</span><span class="p">.</span><span class="nf">divs</span><span class="p">(</span><span class="ss">:class</span><span class="p">,</span> <span class="s2">"blue_text"</span><span class="p">)</span> <span class="c1"># all divs whose class is "blue_text"</span>

<span class="c1"># all divs whose class is "blue_text", and whose title contains 'porpoise'</span>
<span class="n">doc</span><span class="p">.</span><span class="nf">divs</span><span class="p">(</span><span class="ss">:class</span><span class="p">,</span> <span class="s2">"blue_text"</span><span class="p">,</span> <span class="ss">:title</span><span class="p">,</span> <span class="sr">/porpoise/</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>And just for <a href="http://invisibleblocks.wordpress.com/2006/01/18/hacking-the-browsers-dom-for-fun/">fun</a>, let’s let people pass in their own filter blocks:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="n">doc</span><span class="p">.</span><span class="nf">divs</span> <span class="p">{</span> <span class="o">|</span><span class="n">div</span><span class="o">|</span>
    <span class="n">div</span><span class="p">.</span><span class="nf">hasChildNodes</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>The code for the divs method will look like this:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">divs</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="nb">proc</span><span class="p">)</span>
    <span class="nb">proc</span> <span class="o">||=</span> <span class="n">make_filter</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># Find all sub-nodes for which this block evaluates to 'true'</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">find_all</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
        <span class="n">n</span><span class="p">.</span><span class="nf">tagName</span><span class="p">.</span><span class="nf">upcase</span> <span class="o">==</span> <span class="s2">"div"</span><span class="p">.</span><span class="nf">upcase</span> <span class="n">and</span> <span class="nb">proc</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">}</span>
<span class="k">end</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>For those new to Ruby, <code class="highlighter-rouge">*args</code> wraps all the method’s parameters (arguments) in an array, so you can accept variable lists of them…it’s how the method supports calls like <code class="highlighter-rouge">doc.divs(:class, "blue_text", :title, /porpoise/)</code>.  Also, if the method was called with a block, instead of calling it via <code class="highlighter-rouge">yield</code>, we can treat it as a variable by putting <code class="highlighter-rouge">&amp;proc</code> in the method definition, and run it later via <code class="highlighter-rouge">proc.call</code>.</p>

<p>Speaking of that proc…if a block was passed, we’ll use that, but if we got a list of filter parameters, we want to make a filter proc out of them (via <code class="highlighter-rouge">make_filter(args)</code>).  Enter Ruby’s <code class="highlighter-rouge">||=</code> shortcut: <code class="highlighter-rouge">x ||= y</code> is the same as <code class="highlighter-rouge">x = x || y</code>.  If x is non-null, then y doesn’t have to be checked, so <code class="highlighter-rouge">x || y</code> evaluates to the value of x.  If x is null, then <code class="highlighter-rouge">x || y</code> evaluates to the value of y.  It’s a nice idiom for setting optional parameters to default values:  “if a value was passed, use it, but otherwise, use this default.”  Here, <code class="highlighter-rouge">proc ||= make_filter(args)</code> sets proc either to the block that was passed, or to the proc that <code class="highlighter-rouge">make_filter(args)</code> returns.  From there, it’s simple: find all elements where the tag is “DIV”, and the filter procedure returns true.</p>

<h3 id="generating-other-finder-methods">Generating Other Finder Methods</h3>

<p>Now that’s fine for divs, but we want to search for <em>lots</em> of elements this way!  I don’t want copy-paste versions of that method for span, a, p, img, table, and the rest of them…what a mess.  Instead, I’ll write Ruby code to generate them for me, from a template.  Let’s work from the inside out.</p>

<p><code class="highlighter-rouge">module_eval(code)</code> takes a string of Ruby code, and evaluates it in the context of the current module.  In other words, if you pass in code that defines a method, you can then execute that method for the module.  Here, we’ll use it to add methods to the Element class.</p>

<p>But who wants to cram a bunch of code onto one line, in a string variable?  Let’s use Ruby’s multi-line string:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">METHOD_TEMPLATE</span><span class="sh">
    def </span><span class="si">#{</span><span class="n">tag</span><span class="si">}</span><span class="sh">s (*args, &amp;proc)
        proc ||= make_filter(args)
        self.find_all { |n|
            n.tagName.upcase == "</span><span class="si">#{</span><span class="n">tag</span><span class="p">.</span><span class="nf">upcase</span><span class="si">}</span><span class="sh">" and proc.call(n)
        }
    end
</span><span class="no">METHOD_TEMPLATE</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Everything between <code class="highlighter-rouge">&lt;&lt;METHOD_TEMPLATE</code> and <code class="highlighter-rouge">METHOD_TEMPLATE</code> is interpreted as a string, and stored in the code variable (the names “code” and “METHOD_TEMPLATE” can be whatever you want—they’re not specific to generating methods).Sharp readers will notice that that string won’t evaluate without a variable named ‘tag’ in scope, so let’s add that:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="n">searchable_tags</span> <span class="o">=</span> <span class="sx">%w[a p div span input table]</span>

<span class="n">searchable_tags</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">tag</span><span class="o">|</span>
    <span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">METHOD_TEMPLATE</span><span class="sh">
        def </span><span class="si">#{</span><span class="n">tag</span><span class="si">}</span><span class="sh">s (*args, &amp;proc)
            proc ||= make_filter(args)
            self.find_all { |n|
                n.tagName.upcase == "</span><span class="si">#{</span><span class="n">tag</span><span class="p">.</span><span class="nf">upcase</span><span class="si">}</span><span class="sh">" and proc.call(n)
            }
        end
</span><span class="no">METHOD_TEMPLATE</span>
    <span class="nb">module_eval</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This shows off Ruby’s nice <code class="highlighter-rouge">%w[ ... ]</code> short-cut for declaring an array of strings.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="c1"># Normal syntax</span>
<span class="n">searchable_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">,</span> <span class="s2">"div"</span><span class="p">,</span> <span class="s2">"span"</span><span class="p">,</span> <span class="s2">"input"</span><span class="p">,</span> <span class="s2">"table"</span><span class="p">]</span>

<span class="c1"># %w cleans things up!</span>
<span class="n">searchable_tags</span> <span class="o">=</span> <span class="sx">%w[a p div span input table]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Once you’re used to it, the code is much clearer.  Thanks to Greg Brown and his <a href="http://www.oreillynet.com/ruby/blog/2006/06/nubygems_simple_array_definiti_1.html">Nuby Gems column</a> for shedding the light.</p>

<h3 id="meta-programming-wrap-up">Meta-programming Wrap Up</h3>

<p>Specifically from this example, I’ve learned:</p>

<ul>
  <li>Meta-programming is like a mini <a href="http://en.wikipedia.org/wiki/Code_generator">run-time code generator</a> built right into Ruby, and it’ll save you lots of typing—it’s great for keeping your code light.  Remember: module_eval affects classes, instance_eval affects objects.</li>
  <li>For meta-programming, those multi-line strings make a nice template mechanism.  Just remember:  the end label <em>must</em> come right after a newline—no leading whitespace for indenting.  That stumped me for a bit.</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Ruby’s</td>
          <td> </td>
          <td>= is handy—just remember that <code class="highlighter-rouge">a ||= b</code> means <code class="highlighter-rouge">a = a || b</code>.  If a is null, then a evaluates to false, so a is assigned the value of b.</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p>If you want to read more about meta-programming, I’d suggest <a href="http://www.visibleworkings.com/little-ruby/">A Little Ruby, a Lot of Objects</a>, even though it’s only partly about meta-programming.  <a href="http://poignantguide.net/dwemthy/">Dwemthy’s Array</a> is fun (and deranged), but I found it hard to see the meta-programming through the other stuff.  I’m currently chewing on <a href="http://www.whytheluckystiff.net/articles/seeingMetaclassesClearly.html">these</a> <a href="http://www.32768.com/bill/weblog/2005/08/15/selectively_marshal-a-little-ruby-metaprogramming/">bits</a>.  I still need to crack the <code class="highlighter-rouge">metaclass = (class &lt; self; self; end)</code> nut that I keep reading about…any advice?</p>

<h3 id="one-last-thingon-line-documentation">One Last Thing—On-line Documentation</h3>

<p>As much as I’m coming to really like the <a href="http://www.amazon.com/o/asin/0974514055">pickaxe</a>, these <a href="http://ruby.outertrack.com/">Ruby API docs</a>, made with <a href="http://rannotate.rubyforge.org/">RAnnotate</a>, are really handy.  As we start to really invest in Watir, I’ll probably set this up for us locally.</p>

  </article>

  

  <a id='comments'></a>
  <h3>14 Comments on "Ruby, Meta-programming, and Watir"</h3>

  
  <div class='comment'>
    <div><p>You should take a look at Watir 1.5. It’s still in development, but it includes most of the features that you talk about here. And we’d love to have your help with the rest.</p>

<p>Bret</p>
</div>

    
    <span class='author'>
      <a href="http://www.pettichord.com">Bret Pettichord</a>
    </span>
    

    <span class='date'>Wed Jun 21 15:17:00 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>Bret, glad to hear these features are getting into Watir 1.5!  I’ll check it out, and I’d be glad to help out on the project.</p>
</div>

    
    <span class='author'>
      <a href="http://www.blogger.com/profile/6051054">Dan Bernier</a>
    </span>
    

    <span class='date'>Thu Jun 22 21:03:00 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>Oddly enough, I’ve been working in Ruby for almost a year now, using the obj.send() you describe for OLE embedding… but I never quite grasped the “meta” part of the meta-programming that was going on.  This despite the best efforts of several local Ruby enthusiasts.  (OK, I’m QA, not Dev…)</p>

<p>For whatever reason, I’ve had an ah-ha moment reading your comments on the searchable_tags.</p>

<p>Now I’ll have to gem install watir just to read the source.  Thanks much for whatever combination of words made it happen!</p>
</div>

    
    <span class='author'>
      <a href="http://emptiness.mtness.com/">Emptiness</a>
    </span>
    

    <span class='date'>Fri Aug  4 20:25:51 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>Emptiness, glad I could help.  I had the same kind of thing with OO JavaScript – I was using basic JavaScript, kludging together objects only when I really had to.  Once I started reading about functions as first-class members of the language, it clicked for me.</p>

<p>That’s great that you’re involved with the local Ruby scene.  I keep wanting to go visit the one near me…for some reason, physically chatting with people makes it so much easier for me to pick things up.</p>
</div>

    
    <span class='author'>Dan Bernier</span>
    

    <span class='date'>Tue Aug  8 21:34:58 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>So, it would be interesting for you to comment on what it would take for folks at your old job to embrace Ruby…</p>
</div>

    
    <span class='author'>
      <a href="http://duckdown.blogspot.com">James</a>
    </span>
    

    <span class='date'>Thu Sep  7 07:17:07 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>James, that could be a whole post on its own!  You could be sneaky, or up-front about it.</p>

<p>Some sneaky things that might work:</p>

<ol>
  <li>Use Rails for rapid prototyping.  Share the prototype w/ the customers.  Then, once it’s pretty solid, explain why you have to re-write it in Java.</li>
  <li>A skunk-works Rails project that’s important enough to stay around and influence other apps, but not important enough to get you fired.</li>
</ol>

<p>If you wanted to be more up-front, you could replace those super-complicated build batch scripts with Ruby…it’d be MUCH more flexible.  I can expound, if you like…</p>

<p>Why, are you trying to start a Ruby revolution there?  ;-)</p>
</div>

    
    <span class='author'>Dan Bernier</span>
    

    <span class='date'>Thu Sep 14 20:09:27 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>&gt;&gt;I still need to crack the metaclass = (class</p>
</div>

    
    <span class='author'>Stefan Storakers</span>
    

    <span class='date'>Mon Oct 16 11:54:17 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>&gt;&gt;I still need to crack the metaclass = (class  \</p>
</div>

    
    <span class='author'>Stefan Storakers</span>
    

    <span class='date'>Mon Oct 16 11:56:18 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>A third time then:
“why..” has written more about meat programming:
http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html</p>
</div>

    
    <span class='author'>Stefan Storakers</span>
    

    <span class='date'>Mon Oct 16 11:58:41 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>Stefan,</p>

<p>Thanks for the _why link.  I’ve read it before, but it doesn’t have the kind of “what the hell is going on here?” answers I’m looking for.</p>

<p>Ola Bini has a nice post about the Ruby Singleton class at http://ola-bini.blogspot.com/2006/09/ruby-singleton-class.html – that was much more helpful to me.</p>

<p>The thing that initially confused me is that the GoF Singleton is (I think) a substantially different concept than the Ruby Singleton.  Ola lays it out pretty well, and explains the class &lt;&lt; self thing.  I’m still thinking it over, though, and I’m considering doing a write-up here, once it clicks for me.</p>
</div>

    
    <span class='author'>Dan Bernier</span>
    

    <span class='date'>Mon Oct 16 13:16:38 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>my “assert” can not work,  when i run it, it return “nil is not true”.</p>

<p>it does not either due to the expression error, or declare error</p>
</div>

    
    <span class='author'>iccar</span>
    

    <span class='date'>Tue Dec 26 03:43:53 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>iccar,</p>

<p>I’m assuming you mean assert from Ruby’s <code>Test::Unit::TestCase</code>.  From what little you said, it sounds like you’re calling <code>assert(true, someObj)</code>, and <code>someObj</code> is nil.</p>

<p>Also, for future reference, you might want to read <a href="http://catb.org/~esr/faqs/smart-questions.html" rel="nofollow">How To Ask Questions The Smart Way</a>.  It’ll help you get more useful answers to your questions.</p>
</div>

    
    <span class='author'>Dan Bernier</span>
    

    <span class='date'>Tue Dec 26 08:41:43 2006</span>
  </div>
  
  <div class='comment'>
    <div><p>Hi I need some help in programing watir for accessing the headers in internet explorer, something like to play with the tools bar in the hedaer. Can any one help me on that.</p>
</div>

    
    <span class='author'>Murugesan</span>
    

    <span class='date'>Wed Aug 20 10:23:57 2008</span>
  </div>
  
  <div class='comment'>
    <div><p>Actually came here to learn about *args, &amp;proc and got a good explanation about other things as well. Thanks.</p>
</div>

    
    <span class='author'>
      <a href="http://www.talentjr.com">Val</a>
    </span>
    

    <span class='date'>Fri Feb 20 16:07:36 2009</span>
  </div>
  

  
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">


    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <h2 class="footer-heading">Invisible Blocks</h2>
        <p class="text">for building invisible machines</p>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/danbernier">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">danbernier</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/danbernier">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">danbernier</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">I make <a href='http://wordcram.org'>WordCram</a>, and try to make generative art in <a href='http://processing.org'>Processing</a>. I read a fair bit, and I try to write well. I co-organize <a href='http://newhaven.io'>NewHaven.IO</a> and <a href='http://newhavenrb.org'>NewHaven.rb</a>. This is my blog.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
